name: Keep Render Alive
on:
  schedule:
    - cron: "*/10 * * * *"     # 0,10,20...
    - cron: "5-59/10 * * * *"  # 5,15,25...
  workflow_dispatch:

jobs:
  ping-render:
    runs-on: ubuntu-latest
    timeout-minutes: 1
    concurrency:
      group: keep-render-alive
      cancel-in-progress: true
    steps:
      - name: Ping
        env:
          PING_URL: https://laundress-bot.onrender.com/health
        run: |
          date -u
          for i in {1..3}; do
            if curl -fsS --retry 2 --retry-all-errors --connect-timeout 5 --max-time 10 "$PING_URL"; then
              echo "OK"; exit 0
            fi
            echo "retry $i..."; sleep 5
          done
          echo "::error::no response"; exit 1
